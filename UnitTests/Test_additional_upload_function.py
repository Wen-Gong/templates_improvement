import unittest
from Functions.validation import *
from Functions.Update_template import *
#check_the_similarity_of_two_zip_files(s3bucket:str, zipfilename_1:str,zipfilename_2:str)
class Test_check_the_similarity_of_two_zip_files(unittest.TestCase):
    def setUp(self):
        self.variable = {
            'S3BucketName': "444235434904-pvcam-s3-blackbox-template-store-prod",
            'TableName_IMU': 'dailyimu',
            'zipfilename_1': 'templates_v4.zip',
            'zipfilename_2': 'templates_v5.zip'
        }

    def test_check_the_similarity_of_two_zip_files(self):
        variables = self.variable
        result = check_the_similarity_of_two_zip_files(variables['S3BucketName'],variables['zipfilename_1'],variables['zipfilename_2'])
        expect = 'Files are different!'
        self.assertEqual(result, expect)

    def test_check_the_similarity_of_two_zip_files_2(self):
        variables = self.variable
        result = check_the_similarity_of_two_zip_files(variables['S3BucketName'],variables['zipfilename_1'],variables['zipfilename_1'])
        expect = 'Both files are same'
        self.assertEqual(result, expect)

class Test_change_predicted_label(unittest.TestCase):
    def setUp(self):
        self.template_data_1 = { 'rawdata': '{"MetaData": {"deviceId": "ec639c1e-cedc-492b-96fc-018da2e4bbf5", "vehicleId": "00da6d11-e01e-4530-a314-ed552333f72a", "physicalId": "fa2a4954-5ce9-4a19-b327-95978a0285f5", "nodeId": "6885fa55-9941-4104-bab6-ab7e92501d08", "orgId": "7677c7f9-b54f-4cca-b0dc-63a2253bd000", "timeStamp": "2022-11-29T19:44:33Z", "id": "1f603417-07f1-42fd-a596-cf7fde645eb6", "lat": "53.412983", "lng": "-1.403371"}, "Instances": {"features": {"deviceId": "ec639c1e-cedc-492b-96fc-018da2e4bbf5", "event_time": "2022-11-29T19:44:33Z", "start_time": "2022-11-29 19:44:23.009000", "end_time": "2022-11-29 19:44:42.999000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-11-29 19:44:23.009000+00:00", "-0.17", "0.27", "-0.06"], ["2022-11-29 19:44:23.199000+00:00", "-0.18", "0.29", "-0.07"], ["2022-11-29 19:44:23.399000+00:00", "-0.18", "0.3", "-0.05"], ["2022-11-29 19:44:23.600000+00:00", "-0.21", "0.28", "-0.02"], ["2022-11-29 19:44:23.799000+00:00", "-0.19", "0.22", "-0.07"], ["2022-11-29 19:44:23.999000+00:00", "-0.11", "0.11", "0.0"], ["2022-11-29 19:44:24.200000+00:00", "-0.05", "0.04", "0.07"], ["2022-11-29 19:44:24.399000+00:00", "-0.08", "0.03", "0.01"], ["2022-11-29 19:44:24.599000+00:00", "-0.06", "0.08", "-0.04"], ["2022-11-29 19:44:24.799000+00:00", "-0.02", "0.1", "-0.05"], ["2022-11-29 19:44:24.999000+00:00", "-0.08", "0.14", "0.0"], ["2022-11-29 19:44:25.200000+00:00", "-0.1", "0.1", "0.04"], ["2022-11-29 19:44:25.400000+00:00", "-0.15", "0.16", "-0.04"], ["2022-11-29 19:44:25.599000+00:00", "-0.22", "0.24", "-0.04"], ["2022-11-29 19:44:25.799000+00:00", "-0.22", "0.2", "0.01"], ["2022-11-29 19:44:25.999000+00:00", "-0.14", "0.2", "-0.02"], ["2022-11-29 19:44:26.200000+00:00", "-0.18", "0.19", "0.03"], ["2022-11-29 19:44:26.400000+00:00", "-0.07", "0.2", "0.02"], ["2022-11-29 19:44:26.599000+00:00", "-0.13", "0.14", "-0.05"], ["2022-11-29 19:44:26.799000+00:00", "-0.05", "0.17", "-0.0"], ["2022-11-29 19:44:27+00:00", "-0.02", "0.22", "-0.04"], ["2022-11-29 19:44:27.200000+00:00", "-0.02", "0.25", "-0.05"], ["2022-11-29 19:44:27.400000+00:00", "0.02", "0.26", "0.04"], ["2022-11-29 19:44:27.600000+00:00", "0.07", "0.3", "0.02"], ["2022-11-29 19:44:27.800000+00:00", "0.06", "0.32", "-0.12"], ["2022-11-29 19:44:28+00:00", "0.21", "0.26", "-0.01"], ["2022-11-29 19:44:28.199000+00:00", "0.21", "0.18", "0.0"], ["2022-11-29 19:44:28.399000+00:00", "0.14", "0.19", "-0.01"], ["2022-11-29 19:44:28.600000+00:00", "0.24", "0.28", "-0.01"], ["2022-11-29 19:44:28.799000+00:00", "0.06", "0.18", "-0.13"], ["2022-11-29 19:44:28.999000+00:00", "0.17", "0.3", "0.14"], ["2022-11-29 19:44:29.199000+00:00", "0.18", "0.29", "-0.05"], ["2022-11-29 19:44:29.399000+00:00", "0.15", "0.32", "-0.08"], ["2022-11-29 19:44:29.599000+00:00", "0.14", "0.33", "-0.08"], ["2022-11-29 19:44:29.799000+00:00", "0.17", "0.3", "-0.0"], ["2022-11-29 19:44:30+00:00", "0.19", "0.12", "0.1"], ["2022-11-29 19:44:30.199000+00:00", "0.1", "0.28", "-0.12"], ["2022-11-29 19:44:30.399000+00:00", "0.17", "0.37", "-0.08"], ["2022-11-29 19:44:30.600000+00:00", "0.2", "0.14", "0.11"], ["2022-11-29 19:44:30.799000+00:00", "0.3", "0.26", "0.0"], ["2022-11-29 19:44:30.999000+00:00", "0.18", "0.33", "-0.28"], ["2022-11-29 19:44:31.200000+00:00", "0.22", "0.32", "0.03"], ["2022-11-29 19:44:31.399000+00:00", "0.2", "0.34", "-0.05"], ["2022-11-29 19:44:31.600000+00:00", "0.26", "0.29", "-0.08"], ["2022-11-29 19:44:31.800000+00:00", "0.17", "0.24", "0.12"], ["2022-11-29 19:44:32+00:00", "0.15", "0.29", "-0.1"], ["2022-11-29 19:44:32.200000+00:00", "0.15", "0.37", "-0.05"], ["2022-11-29 19:44:32.399000+00:00", "0.21", "0.22", "0.02"], ["2022-11-29 19:44:32.599000+00:00", "0.36", "0.41", "-0.1"], ["2022-11-29 19:44:32.800000+00:00", "0.42", "0.49", "-0.03"], ["2022-11-29 19:44:33+00:00", "0.26", "0.35", "-0.02"], ["2022-11-29 19:44:33.199000+00:00", "0.24", "0.35", "0.02"], ["2022-11-29 19:44:33.400000+00:00", "0.27", "0.38", "0.18"], ["2022-11-29 19:44:33.600000+00:00", "0.14", "0.32", "-0.34"], ["2022-11-29 19:44:33.799000+00:00", "0.38", "0.38", "0.17"], ["2022-11-29 19:44:34+00:00", "0.28", "0.35", "-0.06"], ["2022-11-29 19:44:34.199000+00:00", "0.17", "0.25", "-0.18"], ["2022-11-29 19:44:34.400000+00:00", "0.26", "0.35", "0.04"], ["2022-11-29 19:44:34.599000+00:00", "0.2", "0.31", "-0.06"], ["2022-11-29 19:44:34.800000+00:00", "0.05", "0.14", "0.04"], ["2022-11-29 19:44:35+00:00", "0.04", "0.22", "-0.12"], ["2022-11-29 19:44:35.200000+00:00", "0.15", "0.31", "-0.06"], ["2022-11-29 19:44:35.399000+00:00", "0.13", "0.35", "0.03"], ["2022-11-29 19:44:35.599000+00:00", "0.01", "0.26", "-0.2"], ["2022-11-29 19:44:35.799000+00:00", "-0.08", "0.2", "-0.04"], ["2022-11-29 19:44:36+00:00", "-0.02", "0.28", "0.25"], ["2022-11-29 19:44:36.200000+00:00", "0.05", "0.34", "-0.17"], ["2022-11-29 19:44:36.399000+00:00", "-0.07", "0.22", "-0.17"], ["2022-11-29 19:44:36.600000+00:00", "-0.13", "0.22", "-0.08"], ["2022-11-29 19:44:36.799000+00:00", "-0.03", "0.21", "0.11"], ["2022-11-29 19:44:37+00:00", "-0.06", "0.31", "-0.08"], ["2022-11-29 19:44:37.200000+00:00", "-0.1", "0.22", "-0.04"], ["2022-11-29 19:44:37.399000+00:00", "-0.06", "0.21", "0.07"], ["2022-11-29 19:44:37.605000+00:00", "-0.05", "0.28", "-0.04"], ["2022-11-29 19:44:37.804000+00:00", "-0.08", "0.26", "-0.04"], ["2022-11-29 19:44:38+00:00", "-0.08", "0.23", "0.02"], ["2022-11-29 19:44:38.199000+00:00", "-0.08", "0.2", "-0.03"], ["2022-11-29 19:44:38.400000+00:00", "-0.1", "0.21", "-0.06"], ["2022-11-29 19:44:38.599000+00:00", "-0.14", "0.21", "-0.04"], ["2022-11-29 19:44:38.800000+00:00", "-0.16", "0.17", "-0.1"], ["2022-11-29 19:44:39+00:00", "-0.07", "0.14", "-0.01"], ["2022-11-29 19:44:39.200000+00:00", "-0.03", "0.16", "-0.1"], ["2022-11-29 19:44:39.399000+00:00", "-0.03", "0.14", "-0.02"], ["2022-11-29 19:44:39.599000+00:00", "-0.05", "0.06", "0.1"], ["2022-11-29 19:44:39.799000+00:00", "-0.05", "0.07", "-0.1"], ["2022-11-29 19:44:40+00:00", "0.0", "0.05", "0.03"], ["2022-11-29 19:44:40.200000+00:00", "-0.0", "0.14", "-0.03"], ["2022-11-29 19:44:40.400000+00:00", "0.05", "0.06", "0.03"], ["2022-11-29 19:44:40.599000+00:00", "0.01", "0.05", "-0.01"], ["2022-11-29 19:44:40.799000+00:00", "0.03", "0.03", "0.02"], ["2022-11-29 19:44:41+00:00", "0.01", "0.02", "-0.07"], ["2022-11-29 19:44:41.199000+00:00", "-0.13", "-0.08", "-0.07"], ["2022-11-29 19:44:41.400000+00:00", "-0.1", "-0.02", "-0.09"], ["2022-11-29 19:44:41.599000+00:00", "0.02", "-0.03", "0.01"], ["2022-11-29 19:44:41.800000+00:00", "0.02", "0.05", "-0.23"], ["2022-11-29 19:44:42+00:00", "0.01", "-0.01", "-0.03"], ["2022-11-29 19:44:42.200000+00:00", "0.04", "-0.02", "0.04"], ["2022-11-29 19:44:42.399000+00:00", "0.04", "-0.03", "0.03"], ["2022-11-29 19:44:42.600000+00:00", "0.01", "-0.01", "0.05"], ["2022-11-29 19:44:42.799000+00:00", "0.02", "0.11", "0.01"], ["2022-11-29 19:44:42.999000+00:00", "-0.04", "0.13", "-0.19"]], "EnergyX": 2.3344000000000014, "EnergyY": 5.735499999999997, "EnergyZ": 0.8755000000000004, "MeanDiffX": -5.551115123125783e-17, "MeanDiffY": 7.0360384185619296e-15, "MeanDiffZ": -2.7755575615628914e-17, "DifferenceX": 2.3344000000000014, "DifferenceY": 5.735499999999997, "DifferenceZ": 0.8755000000000004, "HistogramX": [4, 5, 6, 5, 9, 12, 6, 10, 8, 1, 2, 7, 8, 7, 2, 5, 1, 0, 2, 1], "bin_edgesX": [-0.22, -0.188, -0.156, -0.124, -0.092, -0.06, -0.027999999999999997, 0.0040000000000000036, 0.036000000000000004, 0.06800000000000003, 0.1, 0.13199999999999998, 0.164, 0.19600000000000004, 0.228, 0.26, 0.29200000000000004, 0.32400000000000007, 0.3560000000000001, 0.388, 0.42], "bin_edgesXsign": 2.1, "HistogramY": [1, 2, 4, 3, 6, 2, 4, 9, 4, 9, 12, 9, 10, 7, 8, 7, 2, 1, 0, 1], "bin_edgesY": [-0.08, -0.051500000000000004, -0.023000000000000007, 0.005499999999999991, 0.03399999999999999, 0.062499999999999986, 0.09099999999999998, 0.11949999999999998, 0.14799999999999996, 0.17649999999999993, 0.20499999999999996, 0.23349999999999999, 0.26199999999999996, 0.2904999999999999, 0.31899999999999995, 0.3475, 0.37599999999999995, 0.4044999999999999, 0.4329999999999999, 0.46149999999999997, 0.49], "bin_edgesYsign": 4.305, "HistogramZ": [1, 0, 1, 1, 1, 4, 0, 4, 12, 16, 17, 15, 17, 3, 2, 3, 1, 2, 0, 1], "bin_edgesZ": [-0.34, -0.3105, -0.281, -0.2515, -0.222, -0.1925, -0.16299999999999998, -0.13349999999999998, -0.10399999999999998, -0.07449999999999996, -0.044999999999999984, -0.015499999999999958, 0.014000000000000068, 0.04350000000000004, 0.07300000000000006, 0.10250000000000004, 0.13200000000000006, 0.16150000000000003, 0.19100000000000011, 0.22050000000000008, 0.25], "bin_edgesZsign": -0.9449999999999996, "telematicsData": []}, "prediction": {"predicted_label": "harshLeftTurn", "score": [24.52, 27.57, 27.729999999999993], "top_labels": ["harshLeftTurn", "harshLeftTurn", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["66ad74e1-8241-4f53-819a-1749bbff4496", "c0bf2740-1bca-4052-a250-cd4525562f3c", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-11-29T19:44:33.551Z", "local_timestamp": "2022-11-29T19:44:33.551", "timezone_offset": "+00:00", "dst_offset": "+00:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "202249a1-5d85-43fb-95c8-c91d15b1f5d3"}',
                               'new_predicted_label':'bump'}

    def test_change_predicted_label(self):
        new_raw_data = change_predicted_label(self.template_data_1)
        result = new_raw_data['Instances']['prediction']['predicted_label']
        expect = 'bump'
        self.assertEqual(result, expect)

if __name__ == '__main__':
    unittest.main()

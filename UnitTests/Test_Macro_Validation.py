import unittest

import numpy as np
import pandas as pd

import json

from Functions.validation import execute_query,extract_accelemeter_data_from_str_to_array,extract_accelemeter_data_from_list_to_array, match_score_with_one_template, mean_list_of_single_category, template_performance, get_template_array_from_athena, top_three_rate, final_result_of_conditional_judgement, Decide_good_template, divide_dataset_by_classification


class Test_extract_accelemeter_data_from_str_to_array(unittest.TestCase):

    def test_valid_xyz_datapoints(self):
        test_data= "[['2020-10-10 14:23:10.960000+00:00', 0.28, 0.43, -0.12]]"
        exptected =[[0.28, 0.43, -0.12]]
        result = extract_accelemeter_data_from_str_to_array(test_data)
        print(exptected)
        print(result)

        self.assertListEqual(exptected,result)

    def test_multible_xyz_datapoints(self):
        test_data = "[['2020-10-10 14:23:10.960000+00:00', 0.28, 0.43, -0.12]," \
                    "['2020-10-10 14:23:11.380000+00:00', 0.32, 0.32, -0.12]," \
                    "['2020-10-10 14:23:11.590000+00:00', 0.28, 0.24, -0.07]," \
                    "['2020-10-10 14:23:11.765000+00:00', 0.27, 0.12, 0.01]," \
                    "['2020-10-10 14:23:11.980000+00:00', 0.19, 0.04, -0.04]]"
        exptected = [[0.28, 0.43, -0.12],
                     [0.32, 0.32, -0.12],
                     [0.28, 0.24, -0.07],
                     [0.27, 0.12, 0.01],
                     [0.19, 0.04, -0.04]]
        result = extract_accelemeter_data_from_str_to_array(test_data)
        print(exptected)
        print(result)

    def test_empty_xyz_datapoints(self):
        test_data = '[[]]'
        exptected = [[]]
        result = extract_accelemeter_data_from_str_to_array(test_data)
        print(exptected)
        print(result)

        self.assertListEqual(exptected, result)


class Test_match_score_with_one_template(unittest.TestCase):
    def test_valid_matching_score(self):
        test_template = [[-0.0, -0.02, -0.03],
                        [0.0, 0.01, -0.03],
                        [0.0, 0.04, -0.04],
                        [0.0, 0.03, -0.04],
                        [0.0, 0.01, -0.03],
                        [0.02, 0.02, -0.04],
                        [0.0, 0.01, -0.03],
                        [0.0, 0.03, -0.04],
                        [0.0, 0.01, -0.03],
                        [0.02, 0.01, -0.03],
                        [0.0, 0.01, -0.05],
                        [-0.22, 0.03, -0.02],
                        [-0.25, 0.05, -0.03],
                        [-0.23, 0.03, -0.04],
                        [-0.22, -0.0, -0.02],
                        [-0.24, -0.02, -0.03],
                        [-0.28, 0.02, -0.02],
                        [-0.23, 0.06, -0.04],
                        [-0.23, 0.01, -0.04],
                        [-0.3, -0.0, -0.05],
                        [-0.3, -0.07, -0.05],
                        [-0.33, -0.02, -0.05],
                        [-0.3, -0.1, -0.06],
                        [-0.34, -0.11, -0.06],
                        [-0.21, -0.1, -0.05],
                        [-0.01, -0.09, 0.0],
                        [-0.02, -0.05, -0.18],
                        [0.02, -0.08, 0.08],
                        [-0.02, -0.02, -0.12],
                        [-0.43, -0.08, 0.08],
                        [-0.19, -0.07, -0.2],
                        [-0.24, -0.08, 0.09],
                        [-0.31, 0.04, -0.17],
                        [-0.28, 0.07, 0.02],
                        [-0.21, -0.11, -0.01],
                        [-0.2, 0.03, -0.1],
                        [-0.24, -0.05, 0.01],
                        [-0.16, -0.03, -0.04],
                        [-0.17, 0.09, 0.06],
                        [-0.07, 0.15, -0.17],
                        [-0.08, 0.21, 0.17],
                        [-0.09, 0.29, 0.14],
                        [0.02, 0.28, -0.22],
                        [0.06, 0.23, -0.1],
                        [0.33, 0.2, -0.02],
                        [0.68, 0.04, -0.05],
                        [0.82, 0.0, -0.11],
                        [0.83, -0.02, -0.14],
                        [0.78, -0.01, -0.09],
                        [0.92, -0.08, -0.06],
                        [0.91, -0.04, -0.02],
                        [0.78, -0.11, -0.03],
                        [1.01, -0.12, -0.06],
                        [-0.16, 0.0, 0.03],
                        [0.16, 0.01, -0.18],
                        [-0.0, -0.0, 0.06],
                        [0.03, -0.03, -0.04],
                        [-0.0, -0.02, -0.11],
                        [-0.0, -0.05, -0.02],
                        [-0.0, -0.01, -0.05],
                        [0.01, -0.01, -0.03],
                        [-0.0, -0.02, -0.03],
                        [0.02, 0.01, -0.11],
                        [-0.0, -0.01, -0.05],
                        [0.01, -0.01, -0.03],
                        [-0.0, -0.01, -0.05],
                        [-0.0, -0.04, -0.04],
                        [-0.0, -0.04, -0.04],
                        [0.0, 0.03, -0.04],
                        [-0.02, -0.04, -0.04],
                        [-0.22, -0.05, -0.01],
                        [-0.18, 0.05, -0.04],
                        [-0.14, -0.03, -0.03],
                        [-0.25, 0.01, -0.02],
                        [-0.17, 0.05, -0.04],
                        [-0.17, 0.04, -0.04],
                        [-0.19, 0.04, -0.01],
                        [-0.2, 0.07, -0.05],
                        [-0.15, 0.04, -0.02],
                        [-0.14, 0.05, -0.03],
                        [-0.11, 0.05, -0.01],
                        [-0.11, 0.06, -0.04],
                        [-0.1, 0.11, -0.04],
                        [-0.07, 0.06, -0.04],
                        [-0.06, 0.02, -0.11],
                        [-0.01, 0.06, -0.01],
                        [-0.01, 0.04, -0.07],
                        [-0.01, 0.03, -0.02],
                        [-0.0, -0.03, 0.02],
                        [0.03, -0.02, -0.08],
                        [0.01, -0.07, -0.05],
                        [-0.0, -0.04, -0.04],
                        [0.01, -0.09, 0.02],
                        [-0.0, -0.05, -0.04]]

        test_xyz_points_array = [[-0.0, -0.02, -0.03],
                                     [0.0, 0.01, -0.03],
                                     [0.0, 0.04, -0.04],
                                     [0.0, 0.03, -0.04],
                                     [0.0, 0.01, -0.03],
                                     [0.02, 0.02, -0.04],
                                     [0.0, 0.01, -0.03],
                                     [0.0, 0.03, -0.04],
                                     [0.0, 0.01, -0.03],
                                     [0.02, 0.01, -0.03],
                                     [0.0, 0.01, -0.05],
                                     [-0.22, 0.03, -0.02],
                                     [-0.25, 0.05, -0.03],
                                     [-0.23, 0.03, -0.04],
                                     [-0.22, -0.0, -0.02],
                                     [-0.24, -0.02, -0.03],
                                     [-0.28, 0.02, -0.02],
                                     [-0.23, 0.06, -0.04],
                                     [-0.23, 0.01, -0.04],
                                     [-0.3, -0.0, -0.05],
                                     [-0.3, -0.07, -0.05],
                                     [-0.33, -0.02, -0.05],
                                     [-0.3, -0.1, -0.06],
                                     [-0.34, -0.11, -0.06],
                                     [-0.21, -0.1, -0.05],
                                     [-0.01, -0.09, 0.0],
                                     [-0.02, -0.05, -0.18],
                                     [0.02, -0.08, 0.08],
                                     [-0.02, -0.02, -0.12],
                                     [-0.43, -0.08, 0.08],
                                     [-0.19, -0.07, -0.2],
                                     [-0.24, -0.08, 0.09],
                                     [-0.31, 0.04, -0.17],
                                     [-0.28, 0.07, 0.02],
                                     [-0.21, -0.11, -0.01],
                                     [-0.2, 0.03, -0.1],
                                     [-0.24, -0.05, 0.01],
                                     [-0.16, -0.03, -0.04],
                                     [-0.17, 0.09, 0.06],
                                     [-0.07, 0.15, -0.17],
                                     [-0.08, 0.21, 0.17],
                                     [-0.09, 0.29, 0.14],
                                     [0.02, 0.28, -0.22],
                                     [0.06, 0.23, -0.1],
                                     [0.33, 0.2, -0.02],
                                     [0.68, 0.04, -0.05],
                                     [0.82, 0.0, -0.11],
                                     [0.83, -0.02, -0.14],
                                     [0.78, -0.01, -0.09],
                                     [0.92, -0.08, -0.06],
                                     [0.91, -0.04, -0.02],
                                     [0.78, -0.11, -0.03],
                                     [1.01, -0.12, -0.06],
                                     [-0.16, 0.0, 0.03],
                                     [0.16, 0.01, -0.18],
                                     [-0.0, -0.0, 0.06],
                                     [0.03, -0.03, -0.04],
                                     [-0.0, -0.02, -0.11],
                                     [-0.0, -0.05, -0.02],
                                     [-0.0, -0.01, -0.05],
                                     [0.01, -0.01, -0.03],
                                     [-0.0, -0.02, -0.03],
                                     [0.02, 0.01, -0.11],
                                     [-0.0, -0.01, -0.05],
                                     [0.01, -0.01, -0.03],
                                     [-0.0, -0.01, -0.05],
                                     [-0.0, -0.04, -0.04],
                                     [-0.0, -0.04, -0.04],
                                     [0.0, 0.03, -0.04],
                                     [-0.02, -0.04, -0.04],
                                     [-0.22, -0.05, -0.01],
                                     [-0.18, 0.05, -0.04],
                                     [-0.14, -0.03, -0.03],
                                     [-0.25, 0.01, -0.02],
                                     [-0.17, 0.05, -0.04],
                                     [-0.17, 0.04, -0.04],
                                     [-0.19, 0.04, -0.01],
                                     [-0.2, 0.07, -0.05],
                                     [-0.15, 0.04, -0.02],
                                     [-0.14, 0.05, -0.03],
                                     [-0.11, 0.05, -0.01],
                                     [-0.11, 0.06, -0.04],
                                     [-0.1, 0.11, -0.04],
                                     [-0.07, 0.06, -0.04],
                                     [-0.06, 0.02, -0.11],
                                     [-0.01, 0.06, -0.01],
                                     [-0.01, 0.04, -0.07],
                                     [-0.01, 0.03, -0.02],
                                     [-0.0, -0.03, 0.02],
                                     [0.03, -0.02, -0.08],
                                     [0.01, -0.07, -0.05],
                                     [-0.0, -0.04, -0.04],
                                     [0.01, -0.09, 0.02],
                                     [-0.0, -0.05, -0.04]]

        result = match_score_with_one_template(test_template,test_xyz_points_array)
        expected = 1

        self.assertLess(result, expected)

class Test_mean_list_of_single_category(unittest.TestCase):
    def test_valid_matching_score_list(self):
        test_validation_dataset=pd.DataFrame({'bump_template_01': [32,23,43],
                                              'bump_template_23':[24,34,22],
                                              'bump_template_14':[13,22,15],
                                              'bump_template_122': [13, 22, 15],
                                              'harshBraking_template_3':[13,22,15],
                                              'harshBraking_template_21':[13,20,9],
                                              'harshBraking_template_24':[41,34,15],
                                              'harshBraking_template_220': [41, 34, 15],
                                              'harshRightTurn_template_41':[32,15,33],
                                              'harshRightTurn_template_34':[31,12,44],
                                              'harshRightTurn_template_55':[55,22,33],
                                              'harshLeftTurn_template_54':[23,25,35],
                                              'harshLeftTurn_template_44':[15.5,33,35],
                                              'harshLeftTurn_template_123':[32,31,45],
                                              })
        result_1 = mean_list_of_single_category(test_validation_dataset, 'bump')
        exptected_1 = [20.5,25.25,23.75]
        self.assertEqual(exptected_1, result_1)

        result_2 = mean_list_of_single_category(test_validation_dataset, 'harshBraking')
        exptected_2 = [27,27.5, 13.5]
        self.assertEqual(exptected_2, result_2)

#template_performance

class Test_template_performance(unittest.TestCase):
    def test_result_of_template_performance(self):
        test_validation_dataset = pd.DataFrame({'rawdata': ['{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}'],
                                                'bump_template_01': [32, 23, 43],
                                                'bump_template_23': [24, 34, 22],
                                                'bump_template_14': [13, 22, 15],
                                                'bump_template_122': [13, 22, 15],
                                                'harshBraking_template_3': [13, 22, 15],
                                                'harshBraking_template_21': [13, 20, 9],
                                                'harshBraking_template_24': [41, 34, 15],
                                                'harshBraking_template_220': [41, 34, 15],
                                                'harshRightTurn_template_41': [32, 15, 33],
                                                'harshRightTurn_template_34': [31, 12, 44],
                                                'harshRightTurn_template_55': [55, 22, 33],
                                                'harshLeftTurn_template_54': [23, 25, 35],
                                                'harshLeftTurn_template_44': [15.5, 33, 35],
                                                'harshLeftTurn_template_123': [32, 31, 45],
                                                })

        test_template_raw_data = '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}'
        test_template_array = extract_accelemeter_data_from_list_to_array(json.loads(test_template_raw_data)['Instances']['features']['featurevector'])

        result_1=template_performance(test_template_array,test_validation_dataset,'harshBraking')[1]['count']
        expected_1=3
        self.assertEqual(expected_1, result_1)

        result_2 = type(template_performance(test_template_array, test_validation_dataset, 'harshBraking')[0])
        expected_2 = pd.DataFrame
        self.assertEqual(expected_2, result_2)

#get_template_array_from_athena
class Test_get_template_array_from_athena(unittest.TestCase):
    def test_result_format(self):
        test_template_data_query = "select deviceid, rawdata, predictedlabel, eventtime, vehiclename, orgname " \
                                   "from dailyimu " \
                                   "where  predictedlabel = 'harshBraking' " \
                                   "limit 1 "

        result = type(get_template_array_from_athena(test_template_data_query))
        expected = type(np.array([]))
        self.assertEqual(expected, result)

#top_three_rate

class Test_top_three_rate(unittest.TestCase):
    def test_result_of_rate(self):
        test_validation_dataset = pd.DataFrame({'rawdata': ['{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}'],
                                                'bump_template_01': [32, 23, 43],
                                                'bump_template_23': [24, 34, 22],
                                                'bump_template_14': [13, 22, 15],
                                                'bump_template_122': [13, 22, 15],
                                                'harshBraking_template_3': [13, 22, 15],
                                                'harshBraking_template_21': [13, 20, 9],
                                                'harshBraking_template_24': [41, 34, 15],
                                                'harshBraking_template_220': [41, 34, 15],
                                                'harshRightTurn_template_41': [32, 15, 33],
                                                'harshRightTurn_template_34': [31, 12, 44],
                                                'harshRightTurn_template_55': [55, 22, 33],
                                                'harshLeftTurn_template_54': [23, 25, 35],
                                                'harshLeftTurn_template_44': [15.5, 33, 35],
                                                'harshLeftTurn_template_123': [8, 8, 44],
                                                })

        result = top_three_rate(test_validation_dataset)
        expected = 2/3
        self.assertEqual(expected, result)

# final_result_of_conditional_judgement
class Test_final_result_of_conditional_judgement(unittest.TestCase):
    def test_result(self):
        test_validationdata_internal = pd.DataFrame({'rawdata': ['{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}'],
                                                'harshLeftTurn_template_01': [32, 23, 43],
                                                'harshLeftTurn_template_23': [24, 34, 22],
                                                'harshLeftTurn_template_14': [13, 22, 15],
                                                'harshLeftTurn_template_122': [13, 22, 15],
                                                'harshLeftTurn_template_3': [13, 22, 15],
                                                'harshLeftTurn_template_21': [13, 20, 9],
                                                'harshLeftTurn_template_24': [41, 34, 15],
                                                'harshLeftTurn_template_220': [41, 34, 15],
                                                'harshLeftTurn_template_41': [32, 15, 33],
                                                'harshLeftTurn_template_34': [31, 12, 44],
                                                'harshLeftTurn_template_55': [55, 22, 33],
                                                'harshLeftTurn_template_54': [23, 25, 35],
                                                'harshLeftTurn_template_44': [15.5, 33, 35],
                                                'harshLeftTurn_template_123': [8, 8, 45],
                                                })
        final_result_of_conditional_judgement()
        test_validationdata_external = pd.DataFrame({'rawdata': ['{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}',
                                                            '{"MetaData": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "vehicleId": "eeaf71c2-d40c-43bc-9d84-0c97b9d73aab", "physicalId": "691da3d8-c006-45ee-9b41-678c6abee969", "nodeId": "bd58121e-3f0a-44a2-8ca4-70be10e8d195", "orgId": "1a132576-a9ef-462e-acae-0e708c2bddfc", "timeStamp": "2022-10-09T16:47:13Z", "id": "4942d330-6471-421d-b1cb-a076dbaa9a7e", "lat": "53.403813", "lng": "-3.017846"}, "Instances": {"features": {"deviceId": "8e55f89c-38e4-45e3-845e-37f17b185368", "event_time": "2022-10-09T16:47:13Z", "start_time": "2022-10-09 16:47:03.060000", "end_time": "2022-10-09 16:47:22.950000", "trigger": [0.5, 0.4, 2.5], "deviceType": "0", "featurevector": [["2022-10-09 16:47:03.060000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:03.260000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:03.470000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:03.681000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:03.881000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.280000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:04.480000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:04.680000+00:00", "-0.02", "0.06", "-0.0"], ["2022-10-09 16:47:04.880000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:05.100000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:05.300000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.500000+00:00", "-0.08", "0.06", "0.01"], ["2022-10-09 16:47:05.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:05.900000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.100000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.522000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:06.720000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:06.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.120000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:07.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.520000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.730000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:07.930000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.130000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.330000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:08.549000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.749000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:08.949000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:09.160000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:09.360000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.560000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:09.770000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:09.970000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.160000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:10.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:10.579000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:10.781000+00:00", "-0.02", "0.06", "-0.02"], ["2022-10-09 16:47:10.980000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:11.180000+00:00", "-0.03", "0.06", "-0.0"], ["2022-10-09 16:47:11.380000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:11.580000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:11.800000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:12.201000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.400000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:12.600000+00:00", "-0.02", "0.05", "-0.02"], ["2022-10-09 16:47:12.800000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:13+00:00", "-1.45", "0.03", "0.69"], ["2022-10-09 16:47:13.220000+00:00", "-0.15", "0.07", "0.03"], ["2022-10-09 16:47:13.421000+00:00", "0.12", "0.04", "-0.05"], ["2022-10-09 16:47:13.620000+00:00", "0.04", "0.05", "-0.03"], ["2022-10-09 16:47:13.819000+00:00", "0.03", "0.05", "-0.03"], ["2022-10-09 16:47:14.019000+00:00", "-0.0", "0.05", "-0.02"], ["2022-10-09 16:47:14.219000+00:00", "-0.08", "0.05", "-0.01"], ["2022-10-09 16:47:14.440000+00:00", "-0.05", "0.06", "-0.01"], ["2022-10-09 16:47:14.641000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:14.840000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.040000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:15.240000+00:00", "-0.05", "0.05", "-0.01"], ["2022-10-09 16:47:15.440000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:15.639000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:15.860000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:16.061000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.262000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.459000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:16.661000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:16.861000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.060000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.280000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:17.481000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.680000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:17.880000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.080000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:18.280000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.500000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:18.700000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:18.903000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.100000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.302000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.500000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:19.700000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:19.920000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:20.120000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.320000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.521000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:20.720000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:20.920000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.120000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.540000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:21.740000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:21.940000+00:00", "-0.03", "0.05", "-0.0"], ["2022-10-09 16:47:22.140000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.339000+00:00", "-0.03", "0.06", "-0.02"], ["2022-10-09 16:47:22.560000+00:00", "-0.03", "0.05", "-0.02"], ["2022-10-09 16:47:22.749000+00:00", "-0.02", "0.05", "-0.0"], ["2022-10-09 16:47:22.950000+00:00", "-0.03", "0.05", "-0.02"]], "EnergyX": 2.2398000000000047, "EnergyY": 0.27160000000000006, "EnergyZ": 0.5065999999999994, "MeanDiffX": -2.949029909160572e-16, "MeanDiffY": -9.020562075079397e-17, "MeanDiffZ": 7.112366251504909e-17, "DifferenceX": 2.2398000000000047, "DifferenceY": 0.27160000000000006, "DifferenceZ": 0.5065999999999994, "HistogramX": [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 8, 88, 1], "bin_edgesX": [-1.45, -1.3715, -1.293, -1.2145, -1.1360000000000001, -1.0575, -0.9790000000000001, -0.9005000000000001, -0.8220000000000001, -0.7435, -0.665, -0.5865000000000001, -0.5080000000000001, -0.4295000000000002, -0.3510000000000002, -0.2725000000000002, -0.19400000000000017, -0.11550000000000016, -0.037000000000000144, 0.04149999999999987, 0.12], "bin_edgesXsign": -13.965000000000009, "HistogramY": [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 74, 0, 0, 0, 22, 0, 0, 0, 0, 1], "bin_edgesY": [0.03, 0.032, 0.034, 0.036000000000000004, 0.038, 0.04, 0.042, 0.044000000000000004, 0.046, 0.048, 0.05, 0.052000000000000005, 0.054000000000000006, 0.05600000000000001, 0.05800000000000001, 0.060000000000000005, 0.062000000000000006, 0.064, 0.066, 0.068, 0.07], "bin_edgesYsign": 1.0500000000000003, "HistogramZ": [63, 34, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1], "bin_edgesZ": [-0.05, -0.013000000000000005, 0.023999999999999994, 0.060999999999999985, 0.09799999999999999, 0.135, 0.172, 0.20900000000000002, 0.246, 0.283, 0.32, 0.357, 0.39399999999999996, 0.431, 0.468, 0.5049999999999999, 0.5419999999999999, 0.579, 0.6159999999999999, 0.6529999999999999, 0.69], "bin_edgesZsign": 6.719999999999999, "telematicsData": []}, "prediction": {"predicted_label": "harshBraking", "score": [19.56, 19.87, 20.349999999999998], "top_labels": ["harshBraking", "harshBraking", "harshLeftTurn"], "isPotentialAlert": false, "collisionValue": null, "collisionThreshold": 2.5, "uuids": ["8954a4ce-2b89-45ba-91fb-93878f498c30", "055252be-5052-49e7-ae4b-a689bb047e67", "314ce5ff-60fc-462c-b0bc-82d273152967"], "threshold": 25.0}}, "OutputSQSQueueName": "pvcam-prod-BlackboxOutputQueue", "ModelInfo": {"ClassifierGroupId": "imu", "ClassifierIds": ["5af24700-c598-493c-ac98-f0880777e612"], "ClassifierId": "5af24700-c598-493c-ac98-f0880777e612", "arn": "arn:aws:states:us-east-1:846444612901:stateMachine:pvcam-prod-IMUModelStateMachine"}, "timezone_metadata": [{"attribute_name": "timeStamp", "UTC_timestamp": "2022-10-09T16:47:13.481Z", "local_timestamp": "2022-10-09T17:47:13.481", "timezone_offset": "+00:00", "dst_offset": "+01:00"}], "OutputSQSQueueUrl": "https://queue.amazonaws.com/846444612901/pvcam-prod-BlackboxOutputQueue", "RequestId": "e282a484-aac7-4138-a5d3-ff76016bc9e5"}'],
                                                'bump_template_01': [32, 23, 43],
                                                'bump_template_23': [24, 34, 22],
                                                'bump_template_14': [13, 22, 15],
                                                'bump_template_122': [13, 22, 15],
                                                'harshBraking_template_3': [13, 22, 15],
                                                'harshBraking_template_21': [13, 20, 9],
                                                'harshBraking_template_24': [41, 34, 15],
                                                'harshBraking_template_220': [41, 34, 15],
                                                'harshRightTurn_template_41': [32, 15, 33],
                                                'harshRightTurn_template_34': [31, 12, 44],
                                                'harshRightTurn_template_55': [55, 22, 33],
                                                })

        test_template_data_query = "select deviceid, rawdata, predictedlabel, eventtime, vehiclename, orgname " \
                                   "from dailyimu " \
                                   "where  predictedlabel = 'harshBraking' " \
                                   "limit 1 "

        template=get_template_array_from_athena(test_template_data_query)
        result=final_result_of_conditional_judgement(template, test_validationdata_internal, test_validationdata_external,'harshRightTurn')
        expected={'influence_top_3_negatively': True,
                  'influence_top_3_positvely': True,
                  'over_mean_score_is_negative': False,
                  'over_mean_score_is_positive': False}
        self.assertEqual(result, expected)

class Test_Decide_good_template(unittest.TestCase):
        def test_result(self):
            test_dict = {'influence_top_3_negatively': True,
                        'influence_top_3_positvely': True,
                        'over_mean_score_is_negative': False,
                        'over_mean_score_is_positive': False}
            result = Decide_good_template(test_dict)
            expected = 'bad template'
            self.assertEqual(result, expected)

            test_dict_2 = {'influence_top_3_negatively': True,
                         'influence_top_3_positvely': True,
                         'over_mean_score_is_negative': True,
                         'over_mean_score_is_positive': True}
            result_2 = Decide_good_template(test_dict_2)
            print(result_2)
            expected_2 = 'Wonderful Template'
            self.assertEqual(result_2, expected_2)


class Test_divide_dataset_by_classification(unittest.TestCase):
    def test_result(self):
        validation_data=pd.read_csv('C:/Users/WenGong/Downloads/templates_improvement_staging/validation_data.csv')
        result_1 = type(divide_dataset_by_classification(validation_data,'harshBraking')[0])
        expected_1 = pd.DataFrame
        self.assertEqual(result_1, expected_1)

        result_2 = type(divide_dataset_by_classification(validation_data, 'harshBraking')[1])
        expected_2 = pd.DataFrame
        self.assertEqual(result_2, expected_2)

    def test_result_2(self):
        validation_data=pd.read_csv('C:/Users/WenGong/Downloads/templates_improvement_staging/validation_data.csv')
        result_1 = type(divide_dataset_by_classification(validation_data,'harshLeftTurn')[0])
        expected_1 = pd.DataFrame
        self.assertEqual(result_1, expected_1)

        result_2 = type(divide_dataset_by_classification(validation_data, 'harshLeftTurn')[1])
        expected_2 = pd.DataFrame
        self.assertEqual(result_2, expected_2)

